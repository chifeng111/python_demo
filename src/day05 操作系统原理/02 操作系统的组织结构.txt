02 操作系统的组织结构

1、操作系统虚拟机
	在裸机上配置了操作系统程序后就构成了操作系统虚拟机。
	
2、操作系统虚拟化技术
	1) 虚拟CPU调度
		多用户、分时共享
	2) 虚拟存储技术
		逻辑地址和物理地址
	3) 在设备管理中提供虚拟设备和虚拟分配技术
		例如：一个应用程序将一批数据在打印机上输出，实际是写到一个虚拟打印机上。

3、操作系统组织结构
	1) 一体化结构
	2) 模块化结构
	3) 可扩展内核结构
	4) 层次结构

4、处理机的状态
	1) 管态：又称系统态，是操作系统的管理程序执行时机器所处的状态。
		此状态下允许中央处理机使用全部系统资源和全部指令，包括特权指令：
			a、修改机器状态指令
			b、修改特殊寄存器指令
			c、设计外部设备的输入/输出指令
	2) 用户态：是用户程序执行是机器所处的状态。
		此状态下禁止使用特权指令，只允许用户程序访问自己的存储区域。
		如需访问系统资源，则需通过一种受控方式进入操作系统，将用户态转为管态。
		以下情况下，可以由用户态转为管态：
			a、系统调用
			b、发生一次中断
			c、产生一个错误

5、中断机制
	1) 概念：
		某个事件（例如电源断电，IO传输结束...）发生时，系统中止现行程序的运行，
		引出处理该事件程序进行处理，处理完毕后返回断点，继续执行。
	2) 类型
		按功能分：
			a、输入/输出中断
			b、外中断，如时钟中断、操作员控制台中断、多机系统中CPU到CPU的通信中断。
			c、机器故障中断，如主存出错、从主存取指令错、取数据错等。
			d、程序性中断，如越界、非法操作、定点溢出等。
			e、访管中断，对系统提出某种需求是发出的中断。
	3) 中断进入
		中断系统的职能是实现中断的进入，也就是实习中断响应的过程。
		a、保护现场
		b、恢复现场
		现场：中断那一刻能够确保程序继续运行的有关信息。
		现场信息包括：
			后续指令所在主存的单元号
			程序运行所处的状态（用户态还是管态）
			指令执行情况
			程序执行的中间结果
		程序状态字：反映程序执行时机器所处的现行状态的代码。
		中断响应：
			一、将程序状态字寄存器的内容存放到主存约定的单元保存，以备需要返回时再来用它们设置指令计数器和处理器状态寄存器。
			二、将处理中断程序的指令执行地址和处理器状态送人相应的寄存器中，引入处理中断的程序。
	4) 向量中断
		向量中断：当中断发生时，由中断源引导处理机进入中断服务程序的中断过程称为向量中断。
		中断向量：存储该类型中断的中断服务例行程序的入口地址和处理器状态字的存储单元。
		中断向量表：系统中所有中断类型的中断向量放在一起，形成中断向量表。
	5) 中断处理过程
		保护现场和传递参数
		执行相应的中断（自陷）服务例程
		恢复和推出中断
